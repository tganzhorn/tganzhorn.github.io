(this["webpackJsonplcd-simulator"]=this["webpackJsonplcd-simulator"]||[]).push([[0],{39:function(e,t,n){},42:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(15),s=n.n(o),c=(n(39),n(22)),a=n.n(c),u=n(31),d=n(11),l=n(18),m=n(17),h=n(23),f=n(9),b=function e(t){Object(f.a)(this,e),this.type=void 0,this.timestamp=void 0,this.type=t,this.timestamp=new Date},j=function(){function e(){Object(f.a)(this,e),this.currentCommand=new Uint8Array(0),this.newCommand=!1,this.commandBuffer=[],this.debugNumberModes=["u8hex","u16hex","u32hex","u8dez","u16dez","u8bin","u16bin","u32bin"],this.debugTextModes=["text","error","ok"],this._onNewCommand=function(){}}return Object(h.a)(e,[{key:"parseValue",value:function(e){for(var t=0;t<e.length;t++)if(35!==e[t]){if(this.newCommand){if(this.commandBuffer[2]&&this.commandBuffer.length===this.commandBuffer[2]+2){this.commandBuffer.push(e[t]);var n=this.parseCommand();n&&this._onNewCommand(n),this.commandBuffer.length=0,this.newCommand=!1;continue}this.commandBuffer.push(e[t])}}else{if(this.newCommand=!0,0!==this.commandBuffer.length){var r=this.parseCommand();r&&this._onNewCommand(r)}this.commandBuffer.length=0}}},{key:"onNewCommand",set:function(e){this._onNewCommand=e}},{key:"parseCommand",value:function(){if(76===this.commandBuffer[0]){if(2===this.commandBuffer[1]){var e=this.commandBuffer[3],t=this.commandBuffer[4];return new O(e,t)}if(3===this.commandBuffer[1]){var n=this.commandBuffer[3];return new O(n,null)}if(4===this.commandBuffer[1]){var r=this.commandBuffer[3];return new O(null,r)}if(5===this.commandBuffer[1]){var i=String.fromCharCode(this.commandBuffer[3]);return new g(i,1,"normal")}if(6===this.commandBuffer[1]){for(var o=this.commandBuffer[3],s=this.commandBuffer[4],c="",a=5;a<this.commandBuffer.length;a++)c+=String.fromCharCode(this.commandBuffer[a]);return new x(c,o,s)}if(7===this.commandBuffer[1]||8===this.commandBuffer[1]){for(var u=7===this.commandBuffer[1]?"normal":"inverse",d=this.commandBuffer[2],l=this.commandBuffer[3],m=this.commandBuffer[4],h="",f=5;f<this.commandBuffer.length;f++)h+=String.fromCharCode(this.commandBuffer[f]);return new v(h,l,m,d,u)}if(9===this.commandBuffer[1]||10===this.commandBuffer[1]){var b=9===this.commandBuffer[1]?"normal":"invers",j=String.fromCharCode(this.commandBuffer[3]);return new g(j,1,b)}if(12===this.commandBuffer[1])return!1;if(13===this.commandBuffer[1])return!1;if(14===this.commandBuffer[1])return new p}if(68===this.commandBuffer[0]){if(2===this.commandBuffer[1]){for(var y=this.commandBuffer[2],B=this.debugNumberModes[this.commandBuffer[3]-1],k=this.commandBuffer[4]*Math.pow(2,0)+this.commandBuffer[5]*Math.pow(2,1)+this.commandBuffer[6]*Math.pow(2,2)+this.commandBuffer[7]*Math.pow(2,3),R="",S=8;S<this.commandBuffer.length&&0!==this.commandBuffer[S];S++)R+=String.fromCharCode(this.commandBuffer[S]);return new C(R,y,k,B)}if(1===this.commandBuffer[1]){for(var D=this.commandBuffer[2],T=this.debugTextModes[this.commandBuffer[3]-1],M="",F=4;F<this.commandBuffer.length;F++)M+=String.fromCharCode(this.commandBuffer[F]);return new w(M,D,T)}}return console.log(this.commandBuffer),!1}}]),e}(),v=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r,i,o,s){var c;return Object(f.a)(this,n),(c=t.call(this,"DisplayTextCommand")).mode=void 0,c.length=void 0,c.row=void 0,c.column=void 0,c.text=void 0,c.text=e,c.row=r,c.column=i,c.length=o,c.mode=s,c}return n}(b),x=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r,i){var o;return Object(f.a)(this,n),(o=t.call(this,"DisplayPrintColumnCommand")).row=void 0,o.column=void 0,o.text=void 0,o.text=e,o.row=r,o.column=i,o}return n}(b),O=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r){var i;return Object(f.a)(this,n),(i=t.call(this,"DisplaySetCursorCommand")).row=void 0,i.column=void 0,i.row=e,i.column=r,i}return n}(b),p=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(){return Object(f.a)(this,n),t.call(this,"DisplayClearCommand")}return n}(b),g=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r,i){var o;return Object(f.a)(this,n),(o=t.call(this,"DisplayCharCommand")).mode=void 0,o.length=void 0,o.text=void 0,o.text=e,o.length=r,o.mode=i,o}return n}(b),w=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r,i){var o;return Object(f.a)(this,n),(o=t.call(this,"DebugTextCommand")).mode=void 0,o.text=void 0,o.length=void 0,o.text=e,o.length=r,o.mode=i,o}return n}(b),C=function(e){Object(l.a)(n,e);var t=Object(m.a)(n);function n(e,r,i,o){var s;return Object(f.a)(this,n),(s=t.call(this,"DebugNumberCommand")).length=void 0,s.mode=void 0,s.text=void 0,s.number=void 0,s.length=r,s.mode=o,s.text=e,s.number=i,s}return n}(b),y=n(48),B=n(34),k=n(1),R=function(e){var t=e.commands,n=e.clear;return Object(k.jsxs)("div",{style:{flex:"1 1 auto",backgroundColor:"#343a40"},children:[Object(k.jsx)("div",{style:{height:300,overflowY:"auto"},children:Object(k.jsxs)(y.a,{striped:!0,bordered:!0,hover:!0,size:"sm",variant:"dark",children:[Object(k.jsx)("thead",{children:Object(k.jsxs)("tr",{children:[Object(k.jsx)("th",{children:"Time"}),Object(k.jsx)("th",{children:"Message"}),Object(k.jsx)("th",{children:"Number"})]})}),Object(k.jsxs)("tbody",{children:[0===t.length?Object(k.jsx)("tr",{children:Object(k.jsx)("td",{colSpan:3,children:"We did not receive any debug messages yet. \ud83d\ude22"})}):null,t.map((function(e,t){return function(e){return"DebugTextCommand"===e.type}(e)?Object(k.jsx)(S,{command:e},t):function(e){return"DebugNumberCommand"===e.type}(e)?Object(k.jsx)(T,{command:e},t):null}))]})]})}),Object(k.jsx)("div",{style:{padding:8},children:Object(k.jsx)(B.a,{onClick:n,children:"Clear Log"})})]})},S=function(e){var t=e.command,n=t.timestamp,r=t.mode,i=t.text,o="",s="";return"error"===r&&(s="\u274c ",o="lightred"),"ok"===r&&(s="\u2714 ",o="lightgreen"),Object(k.jsxs)("tr",{children:[Object(k.jsx)("td",{children:n.toLocaleTimeString()}),Object(k.jsx)("td",{style:{color:o},colSpan:2,children:s+i})]})},D=function(e,t){if(e.length===t)return e;for(var n=e,r=e.length;r<t;r++)n="0"+n;return n},T=function(e){var t=e.command,n=t.timestamp,r=t.number,i=t.text,o=t.mode;return Object(k.jsxs)("tr",{children:[Object(k.jsx)("td",{children:n.toLocaleTimeString()}),Object(k.jsx)("td",{children:i}),Object(k.jsx)("td",{style:{fontFamily:"Roboto Mono",color:"lightblue"},children:function(e,t){return"u8hex"===t?"0x".concat(D(e.toString(16),2)):"u16hex"===t?"0x".concat(D(e.toString(16),4)):"u32hex"===t?"0x".concat(D(e.toString(16),8)):"u8bin"===t?"0b".concat(D(e.toString(2),8)):"u16bin"===t?"0b".concat(D(e.toString(2),16)):e.toString()}(r,o)})]})},M=function(){function e(t,n,r,i,o,s){Object(f.a)(this,e),this.rows=void 0,this.columns=void 0,this.cursorRow=void 0,this.cursorColumn=void 0,this.commandsReceived=void 0,this.lines=void 0,this.rows=t,this.columns=n,this.cursorColumn=null!==o&&void 0!==o?o:0,this.cursorRow=null!==i&&void 0!==i?i:0,this.commandsReceived=null!==s&&void 0!==s?s:0,this.lines=null!==r&&void 0!==r?r:new Array(t).fill(" ".repeat(n))}return Object(h.a)(e,[{key:"insertTextAt",value:function(t,n,r){if(n>this.rows-1)return this;var i=this.lines[n],o=Math.min(t.length+r,this.columns-r);return this.lines[n]=i.substring(0,r)+t.substring(0,o)+i.substring(r+o,i.length),this.cursorRow=n,this.cursorColumn=Math.min(r+t.length,this.columns-1),this.commandsReceived++,new e(this.rows,this.columns,this.lines,this.cursorRow,this.cursorColumn,this.commandsReceived)}},{key:"insertText",value:function(t){return this.insertTextAt(t,this.cursorRow,this.cursorColumn),this.commandsReceived++,new e(this.rows,this.columns,this.lines,this.cursorRow,this.cursorColumn,this.commandsReceived)}},{key:"setCursor",value:function(t,n){return this.cursorRow=null!==t&&void 0!==t?t:this.cursorRow,this.cursorColumn=null!==n&&void 0!==n?n:this.cursorColumn,this.commandsReceived++,new e(this.rows,this.columns,this.lines,this.cursorRow,this.cursorColumn,this.commandsReceived)}},{key:"clearLines",value:function(){return this.lines=new Array(this.rows).fill(" ".repeat(this.columns)),this.commandsReceived++,new e(this.rows,this.columns,this.lines,this.cursorRow,this.cursorColumn,this.commandsReceived)}},{key:"clearRow",value:function(t){return this.lines[t]=" ".repeat(this.columns),this.commandsReceived++,new e(this.rows,this.columns,this.lines,this.cursorRow,this.cursorColumn,this.commandsReceived)}},{key:"getLines",value:function(){return this.lines}}]),e}(),F=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)([21,8]),i=Object(d.a)(n,2),o=i[0],s=i[1],c=Object(r.useState)(new M(o[1],o[0])),a=Object(d.a)(c,2),u=a[0],l=a[1],m=Object(r.useState)(32),h=Object(d.a)(m,2),f=h[0],b=h[1],j=Object(r.useRef)(null);return Object(r.useImperativeHandle)(t,(function(){return[u,l]})),Object(r.useEffect)((function(){if(j.current&&0!==u.commandsReceived){j.current.style.backgroundColor="#5DFF00",j.current.style.boxShadow="0 0 10px #5DFF00";var e=window.setTimeout((function(){j.current&&(j.current.style.backgroundColor="#aaa",j.current.style.boxShadow="none")}),300);return function(){window.clearTimeout(e)}}}),[u]),Object(r.useEffect)((function(){l(new M(o[1],o[0]))}),[o]),Object(k.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",backgroundColor:"#343a40",padding:8,color:"white"},children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:[Object(k.jsx)("span",{children:"RX:"}),Object(k.jsx)("div",{ref:j,style:{transition:"all 0.1s ease",marginLeft:16,backgroundColor:"#aaa",borderRadius:"50%",width:32,height:32}})]}),Object(k.jsx)("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:Object(k.jsxs)("span",{children:["CMD: ",Object(k.jsx)("span",{style:{fontFamily:"Roboto Mono",color:"lightblue"},children:u.commandsReceived})]})}),Object(k.jsx)("label",{htmlFor:"size",style:{paddingRight:8},children:"LCD-Size:"}),Object(k.jsxs)("select",{id:"size",onChange:function(e){var t=e.target.value.split("x").map((function(e){return parseInt(e)}));s([t[0],t[1]])},value:"".concat(o[0],"x").concat(o[1]),children:[Object(k.jsx)("option",{value:"21x8",children:"21x8"}),Object(k.jsx)("option",{value:"26x13",children:"26x13"})]}),Object(k.jsx)("div",{children:Object(k.jsx)(B.a,{onClick:function(){return l(new M(o[1],o[0]))},children:"Reset Display"})})]}),Object(k.jsxs)("div",{className:"lcd",style:{border:"1px solid black",position:"relative",display:"inline-block",backgroundColor:"#5DFF00",color:"black"},children:[Object(k.jsxs)("div",{style:{position:"absolute",right:0},children:[Object(k.jsx)("span",{onClick:function(){return b((function(e){return Math.min(48,e+1)}))},children:"\u2795"}),Object(k.jsx)("span",{onClick:function(){return b((function(e){return Math.max(12,e-1)}))},children:"\u2796"})]}),u.getLines().map((function(e,t){return Object(k.jsx)("div",{style:{lineHeight:1,letterSpacing:"0.3em",fontFamily:"VT323",fontSize:f,whiteSpace:"pre"},children:e},t+e)}))]})]})})),L=(n(42),n(52)),N=n(49),I=n(50),P=n(51);var z=function(){var e=Object(r.useState)(),t=Object(d.a)(e,2),n=t[0],i=t[1],o=Object(r.useState)(),s=Object(d.a)(o,2),c=s[0],l=s[1],m=Object(r.useState)([]),h=Object(d.a)(m,2),f=h[0],b=h[1],v=Object(r.useState)(!1),x=Object(d.a)(v,2),O=x[0],p=x[1],g=Object(r.useRef)(),w=Object(r.useRef)(),C=Object(r.useRef)();Object(r.useEffect)((function(){navigator.serial&&i(navigator.serial)}),[]),Object(r.useEffect)((function(){if(c)return S(c),function(){}}),[c]);var y=function(){var e=Object(u.a)(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.requestPort();case 3:if(t=e.sent,24597===(r=t.getInfo()).usbProductId||1027===r.usbVendorId){e.next=8;break}return alert("This device is not supported!"),e.abrupt("return");case 8:p(!0),l(t),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),p(!1);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(a.a.mark((function e(t){var n,r,i,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.open({baudRate:460800,parity:"none",stopBits:1,dataBits:8,flowControl:"none"});case 3:if(!t.readable||!t.writable){e.next=36;break}return n=new j,e.next=7,t.readable.getReader();case 7:return r=e.sent,e.next=10,t.writable.getWriter();case 10:i=e.sent,w.current=r,C.current=i,n.onNewCommand=function(e){var t=Object(d.a)(g.current,2),n=t[0],r=t[1];"DebugNumberCommand"!==e.type&&"DebugTextCommand"!==e.type||b((function(t){return t.concat([e])})),"DisplayCharCommand"===e.type&&r(n.insertText(e.text)),"DisplayTextCommand"===e.type&&r(n.insertTextAt(e.text,e.row,e.column)),"DisplaySetCursorCommand"===e.type&&r(n.setCursor(e.row,e.column)),"DisplayClearCommand"===e.type&&r(n.clearLines())},o=new Uint8Array([7]),e.prev=15;case 16:return e.next=19,r.read();case 19:if(s=e.sent,c=s.value,!s.done){e.next=26;break}return r.releaseLock(),i.releaseLock(),e.abrupt("break",29);case 26:c&&(n.parseValue(c),i.write(o)),e.next=16;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(15),console.log(e.t0);case 34:e.next=3;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(0),console.log(e.t1);case 41:case"end":return e.stop()}}),e,null,[[0,38],[15,31]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100vh"},children:[Object(k.jsx)(L.a,{bg:"dark",variant:"dark",expand:"lg",children:Object(k.jsx)(N.a,{children:Object(k.jsx)(L.a.Brand,{children:"LCD-Simulator"})})}),Object(k.jsx)(I.a,{fluid:!0,style:{flex:"1 1 auto"},children:Object(k.jsx)(N.a,{children:O?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(F,{ref:g}),Object(k.jsx)(R,{clear:function(){return b([])},commands:f})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("h1",{children:"No device connected!"}),Object(k.jsx)("p",{children:'Please connect to a device by pressing the "Open COM Port" button.'}),Object(k.jsx)(B.a,{variant:"primary",onClick:y,children:"Open COM Port"})]})})}),void 0===navigator.serial?Object(k.jsxs)(P.a,{show:!0,backdrop:"static",children:[Object(k.jsx)(P.a.Header,{children:Object(k.jsx)(P.a.Title,{children:"Your browser is not supported!"})}),Object(k.jsx)(P.a.Body,{children:"To use this app you need to install a chrome (v89+), opera (v76+) or edge (v89+) browser."})]}):null]})},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,53)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),o(e),s(e)}))};s.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(z,{})}),document.getElementById("root")),A()}},[[46,1,2]]]);
//# sourceMappingURL=main.e11317af.chunk.js.map